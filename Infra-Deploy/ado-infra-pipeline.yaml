trigger: none
  # - master

pool:
  vmImage: ubuntu-latest

variables:
 - group: arm-variables
 - name: Location1
   value: "$(Location)"
 - name: ResourceGroupName1 
   value: "$(ResourceGroupName)"
 - name: K8sClusterName1
   value: "$(K8sClusterName)"

resources:
- repo: self

stages:
- stage: CI_Infra_Deploy
  displayName: Infra Deploy
  jobs:
  - job: Deploy_AKS
    displayName: AKS Job
    steps:
    - task: AzureCLI@2
      displayName: 'Deploy AKS'
      inputs:
        azureSubscription: $(AzureResourceManagerConnection)
        scriptType: bash
        scriptLocation: inlineScript
        addSpnToEnvironment: true
        inlineScript: |
          #!/bin/bash

          
          az group create -l southindia -n aks-rg
          az aks create -g aks-rg -n aks-cluster --enable-managed-identity --node-count 1 --generate-ssh-keys
          